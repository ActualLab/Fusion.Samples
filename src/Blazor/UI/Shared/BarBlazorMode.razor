@using Stl.OS
@using System.Web
@inject BlazorModeHelper BlazorModeHelper

<BarDropdown Class="@CssClass">
    <BarDropdownToggle Color="Color.Primary">
        Blazor @Mode.ToString()
    </BarDropdownToggle>
    <BarDropdownMenu>
        <BarDropdownItem Active="IsServerSideBlazor" Clicked="@(() => ChangeMode(BlazorMode.Server))" >Server</BarDropdownItem>
        <BarDropdownItem Active="!IsServerSideBlazor" Clicked="@(() => ChangeMode(BlazorMode.WASM))">WebAssembly</BarDropdownItem>
    </BarDropdownMenu>
</BarDropdown>

@code {
    enum BlazorMode
    {
        Server,
        WASM
    }

    [Parameter]
    public string CssClass { get; set; } = "";

    private BlazorMode Mode = BlazorModeHelper.IsServerSideBlazor ? BlazorMode.Server : BlazorMode.WASM;

    private void ChangeDropdownTitle()
        => Mode = BlazorModeHelper.IsServerSideBlazor ? BlazorMode.Server : BlazorMode.WASM;
    
    private void ChangeMode(BlazorMode mode)
    {
        BlazorModeHelper.ChangeMode(mode == BlazorMode.Server);
        ChangeDropdownTitle();
    }
}
