@using Stl.OS
@using System.Web
@inject BlazorModeHelper BlazorModeHelper

<BarDropdown Class="@CssClass">
    <BarDropdownToggle Color="Color.Primary">
        Blazor @Mode.ToString()
    </BarDropdownToggle>
    <BarDropdownMenu>
        <BarDropdownItem Active="IsServerSideBlazor" Clicked="@(() => ChangeMode(isServerSideBlazor))" >Server</BarDropdownItem>
        <BarDropdownItem Active="!IsServerSideBlazor" Clicked="@(() => ChangeMode(!isServerSideBlazor))">WebAssembly</BarDropdownItem>
    </BarDropdownMenu>
</BarDropdown>

@code {
    enum BlazorMode
    {
        Server,
        WASM
    }

    [Parameter]
    public string CssClass { get; set; } = "";

    private BlazorMode Mode = BlazorModeHelper.IsServerSideBlazor ? BlazorMode.Server : BlazorMode.WASM;

    private bool isServerSideBlazor = BlazorModeHelper.IsServerSideBlazor;

    private void ChangeDropdownTitle()
        => Mode = BlazorModeHelper.IsServerSideBlazor ? BlazorMode.Server : BlazorMode.WASM;
    
    private void ChangeMode(bool isServerSideBlazor)
    {
        BlazorModeHelper.ChangeMode(isServerSideBlazor);
        ChangeDropdownTitle();
    }
}
